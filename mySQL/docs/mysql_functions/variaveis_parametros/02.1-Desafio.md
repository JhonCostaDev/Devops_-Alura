Em uma plataforma de aluguel de curto prazo, entender a ocupação atual das hospedagens disponíveis é essencial para gerenciar efetivamente as propriedades e otimizar as taxas de ocupação. Como parte do esforço contínuo para melhorar a análise de dados e a tomada de decisão, a empresa busca implementar uma função no MySQL que calcule a ocupação média das hospedagens. Esta métrica ajudará a equipe de gestão a avaliar o desempenho das propriedades em sua plataforma.

## Desafio
Como pessoa desenvolvedora da equipe, você recebeu a responsabilidade de criar uma função no MySQL para `determinar a ocupação média das hospedagens`. A função deve calcular a média de hospedagens ocupadas em relação ao total de hospedagens listadas. Para simplificar, assuma que cada registro na tabela de alugueis representa uma ocupação e que o total de registros na tabela de hospedagens representa o número total de hospedagens disponíveis.

```sql
DELIMITER $$

CREATE FUNCTION CalcularOcupacaoMedia() RETURNS DECIMAL(5,2)
DETERMINISTIC
BEGIN
    DECLARE totalHospedagens INT;
    DECLARE totalOcupadas INT;
    DECLARE ocupacaoMedia DECIMAL(5,2);

    -- Calcula o número total de hospedagens listadas
    SELECT COUNT(*) INTO totalHospedagens FROM hospedagens;
    
    -- Calcula o número total de hospedagens ocupadas
    SELECT COUNT(*) INTO totalOcupadas FROM alugueis;

    -- Calcula a ocupação média como um percentual
    SET ocupacaoMedia = (totalOcupadas / totalHospedagens) * 100;

    RETURN ocupacaoMedia;
END$$

DELIMITER ;
```

Início e Fim: A função começa com CREATE FUNCTION CalcularOcupacaoMedia() RETURNS DECIMAL(5,2) indicando que ela não aceita parâmetros e retorna um número decimal com precisão de 5 dígitos no total e 2 dígitos após o ponto decimal. O DETERMINISTIC sugere que a função sempre retornará o mesmo resultado para um dado conjunto de entradas no banco de dados.

## Declaração de variáveis:

totalHospedagens: Variável para armazenar o número total de hospedagens listadas no banco de dados.
totalOcupadas: Variável para armazenar o número total de hospedagens que foram efetivamente alugadas.
ocupacaoMedia: Variável para calcular e armazenar a ocupação média das hospedagens como um percentual.
Cálculo do número total de hospedagens:

A consulta SELECT COUNT(*) INTO totalHospedagens FROM hospedagens: calcula o número total de registros na tabela hospedagens e armazena esse valor na variável totalHospedagens.
Cálculo do número total de hospedagens ocupadas:

A consulta SELECT COUNT(*) INTO totalOcupadas FROM alugueis: calcula quantas hospedagens foram alugadas, assumindo que cada registro na tabela alugueis representa uma hospedagem ocupada, e armazena esse valor na variável totalOcupadas.
Cálculo da ocupação média:

A operação SET ocupacaoMedia = (totalOcupadas / totalHospedagens) * 100: divide o número total de hospedagens ocupadas pelo número total de hospedagens listadas para encontrar a proporção de hospedagens ocupadas e multiplica o resultado por 100 para converter essa proporção em um percentual. O resultado é armazenado na variável ocupacaoMedia.
Retorno:

RETURN ocupacaoMedia: retorna o valor calculado da ocupação média como um percentual.