# procedures e funções

No MySQL, assim como em outros sistemas de gerenciamento de banco de dados (SGBD), é comum combinar procedures (procedimentos armazenados) com funções para realizar tarefas complexas ou repetitivas. Esta combinação permite encapsular lógicas de negócios e operações de dados em blocos reutilizáveis e modulares.

## O que é um Procedure no MySQL?

Um procedure no MySQL é um bloco de comandos SQL armazenado no banco de dados que pode executar operações como leitura, escrita, cálculos e manipulação de dados. Procedures podem aceitar parâmetros de entrada e saída, permitindo que sejam mais dinâmicos e flexíveis.

## Como Criar um Procedure

Para criar um procedure no MySQL, você usa a instrução `CREATE PROCEDURE`, seguida pelo nome do procedure e, opcionalmente, parâmetros de entrada e saída. O corpo do procedure é definido dentro de um bloco `BEGIN` ... `END`.

Sintaxe básica:

```sql
DELIMITER $$

CREATE PROCEDURE nome_do_procedure (param1 tipo, param2 tipo, ...)
BEGIN
    -- Comandos SQL aqui
END$$

DELIMITER ;
```
## Quando usar procedures

* `Automatizar tarefas repetitivas`: Para executar sequências complexas de comandos SQL que precisam ser repetidas frequentemente.

* `Encapsular lógicas de negócios`: Quando a lógica de manipulação de dados precisa ser escondida ou isolada da aplicação principal.
* `Melhorar a performance`: Reduzir o tráfego de rede executando operações complexas diretamente no servidor de banco de dados.
* `Segurança`: Restringir o acesso direto às tabelas, controlando as operações por meio de procedures.

##  Chamando Funções em um Procedure

Você pode chamar funções dentro de um procedure da mesma maneira que faria em qualquer consulta SQL normal. As funções podem ser funções nativas do MySQL ou funções definidas pelo usuário. Elas são úteis para realizar cálculos, formatar dados ou executar qualquer lógica específica que tenha sido encapsulada em uma função.

### Exemplo:

Suponha que você tenha uma função `CalcularDesconto(valor DECIMAL)` que calcula um desconto baseado em regras de negócios específicas. Para usar essa função dentro de um procedure, você faria:


```sql
DELIMITER $$

CREATE PROCEDURE AplicarDescontoNaCompra(INOUT valorTotal DECIMAL)
BEGIN
    DECLARE desconto DECIMAL;
    
    -- Chama a função CalcularDesconto e armazena o resultado em desconto
    SET desconto = CalcularDesconto(valorTotal);
    
    -- Aplica o desconto ao valor total
    SET valorTotal = valorTotal - desconto;
END$$

DELIMITER ;
```

Neste exemplo, o procedure `AplicarDescontoNaCompra` utiliza a função `CalcularDesconto` para calcular um desconto com base no valorTotal de uma compra e então aplica esse desconto ao valor total.

## Considerações Finais

A capacidade de chamar funções dentro de procedures permite um alto grau de reutilização e modularização do código SQL, facilitando a manutenção e a gestão de lógicas de negócios complexas. É uma prática recomendada para desenvolvedores de banco de dados explorar essas funcionalidades para construir aplicações mais eficientes e seguras.