análise de desempenho das hospedagens


Você é um analista de dados em uma plataforma de hospedagem que conecta proprietários de imóveis com potenciais hóspedes. A plataforma coleta avaliações dos clientes após cada estadia, e a equipe de gerenciamento quer entender melhor o desempenho das hospedagens em diferentes cidades, além de identificar áreas de melhoria.

Desafio: Sua tarefa é criar uma consulta SQL que forneça um resumo das avaliações das hospedagens por cidade, incluindo a média das notas de avaliação e o número total de avaliações. Além disso, para facilitar a leitura do relatório pela equipe de gerenciamento, as cidades devem ser apresentadas em letras maiúsculas.

Estruturas relevantes das tabelas
Tabela de Hospedagens: Contém hospedagem_id, tipo, e endereco_id.
Tabela de Avaliações: Contém avaliacao_id, cliente_id, hospedagem_id, nota, e comentario.
Tabela de Endereços: Contém endereco_id, cidade.

```sql
select e.cidade, count(a.avaliacao_id) total_avaliacoes, avg(a.nota) media from avaliacoes a
join hospedagens h on a.hospedagem_id = h.hospedagem_id
join enderecos e on h.endereco_id = e.endereco_id
group by e.cidade
order by media desc, total_avaliacoes desc;
```
