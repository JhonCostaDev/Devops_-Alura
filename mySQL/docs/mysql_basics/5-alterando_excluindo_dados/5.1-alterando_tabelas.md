# Alterando Tabelas - Adicionando coluna na tabela Proprietarios

Como podemos acrescentar uma coluna em uma tabela já existente? No MySQL Workbench, vamos abrir uma nova aba de consulta. Nela, usaremos o comando **ALTER TABLE**, um comando de alteração de tabelas, em que podemos acrescentar uma coluna, que é o que vamos fazer.

Portanto, vamos inserir o comando **ALTER TABLE** seguido do nome da tabela que vamos modificar, que é a tabela de proprietários. Em seguida, vamos utilizar a função **ADD**, seguido de **COLUMN**, para adicionar uma coluna. Nomearemos essa coluna como qtd_hospedagens, que irá armazenar a quantidade de hospedagens que cada proprietário tem.

```SQL
ALTER TABLE proprietarios
ADD COLUMN qtd_hospedagens
```

Junto ao nome, especificaremos o tipo de dado que essa coluna irá conter, o que é fundamental para determinar a estrutura da tabela. No caso, essa coluna será do tipo INT, representando números inteiros.

```SQL
ALTER TABLE proprietarios
ADD COLUMN qtd_hospedagens INT;
```

Dessa forma, conseguiremos adicionar essa coluna à tabela de proprietários. Vamos executar para verificar se a adição é feita corretamente.



## Renomeando a tabela de alugueis para reservas

Agora, temos mais uma modificação que a Insight Places gostaria de fazer: mudar o nome da tabela alugueis para reservas. Para fazer essa modificação do nome da tabela, usaremos a mesma função **ALTER TABLE**, especificando uma mudança diferente.

Nessa mesma aba de consulta, vamos inserir essa nova alteração passando **ALTER TABLE** alugueis, que é o nome da tabela que queremos renomear. Agora, ao invés de usar **ADD COLUMN**, que seria para adicionar uma coluna, utilizaremos **RENAME TO**, indicando que queremos renomear a tabela, e reservas, que é o novo nome.

```SQL
ALTER TABLE alugueis RENAME TO reservas;
```

Quando temos uma aba de consulta com várias consultas diferentes e queremos rodar apenas uma delas, basta selecionar a consulta desejada com o mouse e clicar no botão "**Execute the selected portion of the script or everything, if there is no selection**", representado pelo símbolo de um raio. Assim, a consulta será executada com sucesso.

## Renomeando coluna na tabela de reservas
Ao revisarmos novamente nossa aba de esquemas na lateral esquerda, veremos que a última tabela, de aluguéis, já teve o nome modificado para reservas. No entanto, ao abrir esta tabela de reservas e verificar as colunas, ainda encontramos uma coluna chamada aluguel_id, o que não faz mais sentido, uma vez que agora se trata dos IDs das reservas. Como a tabela mudou de nome para reservas, faz sentido também renomearmos essa coluna.

Ainda nesta consulta, usaremos o mesmo comando **ALTER TABLE**, especificando o nome da tabela que será modificada, que agora é a tabela de reservas. Em seguida, colocaremos **RENAME COLUMN**, para indicar que queremos renomear uma coluna, e informaremos o nome da coluna que será renomeada, que é aluguel_id, seguido de TO e do novo nome desejado, que é reserva_id.

```SQL
ALTER TABLE reservas RENAME COLUMN aluguel_id TO reserva_id;
```

Como desejamos rodar apenas essa linha de consulta, basta selecioná-la e executá-la. Ao fazer isso, a consulta foi concluída com sucesso.

Na aba de esquemas na lateral esquerda, clicaremos para atualizar. Agora, a coluna da tabela de reservas referente ao ID já está com o nome alterado para reserva_id.

## Conclusão e próximos passos
Assim como utilizamos esse comando de alteração para realizar essas modificações de nome de coluna e adicionar colunas, o MySQL oferece diversas formas de trabalhar com esse comando. De fato, há várias outras operações interessantes que podemos realizar com o ALTER TABLE no MySQL, e deixaremos uma atividade para explorar um pouco mais sobre essas funcionalidades.

## Para saber mais: possibilidades de utilização da função ALTER

A função **ALTER** no **MySQL** é uma ferramenta versátil e poderosa usada para modificar a estrutura de tabelas existentes em um banco de dados. Esta função pode ser aplicada de diversas maneiras para atender a uma ampla gama de necessidades de gerenciamento e manutenção de dados. Vamos conhecer as principais possibilidades de aplicação da função **ALTER** no **MySQL**, ilustrando sua flexibilidade e capacidade de adaptação às mudanças nos requisitos de dados.

### Modificar Estrutura de Tabela
* **Adicionar Colunas**: Permite adicionar uma ou mais colunas a uma tabela existente. Isso é útil quando novos tipos de informação precisam ser armazenados para registros existentes.

```SQL
ALTER TABLE tabela ADD COLUMN nova_coluna TIPO_DE_DADO;
```

* **Eliminar Colunas**: Remove uma ou mais colunas de uma tabela. Essencial para quando certos dados não são mais necessários.

```SQL
ALTER TABLE tabela DROP COLUMN coluna;
```

* **Modificar Colunas**: Altera o tipo de dados, o tamanho ou outras propriedades de uma coluna existente. Isso é frequentemente usado para otimizar o armazenamento de dados ou corrigir estruturas de dados inadequadas.

```SQL
ALTER TABLE tabela MODIFY COLUMN coluna NOVO_TIPO_DE_DADO;
```

* **Renomear Colunas**: Muda o nome de uma coluna, o que é útil para corrigir erros de digitação ou realizar reestruturações no esquema de dados.

```SQL
ALTER TABLE tabela RENAME COLUMN coluna_atual TO nova_coluna;
```

### Modificar Chaves e Índices

* **Adicionar Chaves Primárias**: Insere uma chave primária em uma tabela, o que é crucial para garantir a unicidade dos registros.

```SQL
ALTER TABLE tabela ADD PRIMARY KEY (coluna);
```
* **Remover Chaves Primárias**: Elimina a chave primária de uma tabela, permitindo alterações na estrutura de dados que antes eram restritas.
```SQL
ALTER TABLE tabela DROP PRIMARY KEY;
```

* **Adicionar Índices**: Cria um índice em uma ou mais colunas para melhorar a performance de consultas.

```SQL
ALTER TABLE tabela ADD INDEX nome_do_indice (coluna);
```
* **Eliminar Índices**: Remove índices existentes, o que pode ser necessário durante otimizações ou reestruturações de tabelas.

```SQL
ALTER TABLE tabela DROP INDEX nome_do_indice;
```

### Alterações de Engenharia e Otimização

* **Mudar o Tipo de Tabela**: Altera o mecanismo de armazenamento da tabela (por exemplo, de MyISAM para InnoDB), o que pode afetar a performance, a integridade transacional e o suporte a chaves estrangeiras.

```SQL
ALTER TABLE tabela ENGINE = InnoDB;
```

* **Adicionar Chaves Estrangeiras**: Define relações entre tabelas, essenciais para manter a integridade referencial dos dados.

```SQL
ALTER TABLE tabela ADD CONSTRAINT fk_nome_da_chave FOREIGN KEY (coluna) REFERENCES outra_tabela (coluna);
```
* **Modificar Opções de Tabela**: Permite alterar várias configurações da tabela, como o conjunto de caracteres e o collation.

```SQL
ALTER TABLE tabela CONVERT TO CHARACTER SET charset_name COLLATE collation_name;
```

A função **ALTER** é indispensável no dia a dia de administradores de banco de dados e desenvolvedores, permitindo a manutenção e a evolução contínua da estrutura de dados sem a necessidade de criar novas tabelas e migrar dados. Porém, é importante usar essa função com cautela, especialmente em sistemas em produção, pois alterações na estrutura de tabelas podem afetar a performance e a disponibilidade do banco de dados. Recomenda-se sempre testar as alterações em um ambiente de desenvolvimento ou teste e realizar backups antes de aplicar mudanças significativas em um ambiente de produção.